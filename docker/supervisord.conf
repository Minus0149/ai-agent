[supervisord]
nodaemon=true
logfile=/tmp/supervisord.log
pidfile=/tmp/supervisord.pid
childlogdir=/tmp
silent=false

[rpcinterface:supervisor]
supervisor.rpcinterface_factory = supervisor.rpcinterface:make_main_rpcinterface

[program:xvfb]
command=/usr/bin/Xvfb :1 -screen 0 1920x1080x24 -ac +extension GLX +render -noreset
autorestart=true
stdout_logfile=/tmp/xvfb.log
stderr_logfile=/tmp/xvfb_error.log
priority=100

[program:fluxbox]
command=/usr/bin/fluxbox -display :1
autorestart=true
stdout_logfile=/tmp/fluxbox.log
stderr_logfile=/tmp/fluxbox_error.log
environment=DISPLAY=":1"
priority=200

[program:x11vnc]
command=/usr/bin/x11vnc -forever -usepw -create -shared -display :1 -rfbport 5901
autorestart=true
stdout_logfile=/tmp/x11vnc.log
stderr_logfile=/tmp/x11vnc_error.log
environment=DISPLAY=":1"
priority=300

[program:fastapi]
command=/usr/local/bin/uvicorn main:app --host 0.0.0.0 --port 8000 --reload
directory=/app
autorestart=true
stdout_logfile=/tmp/fastapi.log
stderr_logfile=/tmp/fastapi_error.log
environment=DISPLAY=":1",PYTHONPATH="/app"
priority=400